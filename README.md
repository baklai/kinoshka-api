# Kinoshka API

## Передумови

- Git - [Завантажте та встановіть Git](https://git-scm.com/downloads).
- Node.js - [Завантажте та встановіть Node.js](https://nodejs.org/en/download/) і менеджер пакетів npm.

## Завантаження

```bash
git clone
```

## Встановлення NPM модулів

```bash
$ npm install
```

## Змінні проекту

| Ключ            | Коментар                      |
| --------------- | ----------------------------- |
| `PORT`          | Порт API (необов'язковий)     |
| `HOST`          | Хост API (необов'язковий)     |
| `MONGO_URI`     | URI MongoDB                   |
| `ACCESS_SECRET` | Секретний ключ токена доступу |

## Схема даних: Фільм (Movie)

| Поле            | Тип      | Опис                                                                       |
| --------------- | -------- | -------------------------------------------------------------------------- |
| `id`            | string   | Унікальний ідентифікатор фільму (MongoId)                                  |
| `title`         | string   | Назва фільму українською (обов'язкове поле)                                |
| `originalTitle` | string   | Оригінальна назва фільму (опціонально)                                     |
| `description`   | string   | Опис фільму (опціонально)                                                  |
| `poster`        | string   | Посилання на постер фільму (опціонально)                                   |
| `quality`       | string   | Якість відео (наприклад, HD, FullHD) (опціонально)                         |
| `duration`      | string   | Тривалість фільму (у хвилинах або форматі "2 год 10 хв") (опціонально)     |
| `age`           | string   | Вікове обмеження (наприклад, "16+") (опціонально)                          |
| `year`          | string   | Рік виходу фільму (опціонально)                                            |
| `imdb`          | string   | Рейтинг IMDb (опціонально)                                                 |
| `likes`         | string   | Кількість вподобань (опціонально)                                          |
| `dislikes`      | string   | Кількість невподобань (опціонально)                                        |
| `genres`        | string[] | Жанри фільму (масив рядків, наприклад: ["комедія", "драма"]) (опціонально) |
| `actors`        | string[] | Актори (масив імен акторів) (опціонально)                                  |
| `directors`     | string[] | Режисери (масив імен режисерів) (опціонально)                              |
| `countries`     | string[] | Країни виробництва (масив назв країн) (опціонально)                        |
| `episodes`      | object[] | Серії (для серіалів; масив об'єктів з інформацією про серію) (опціонально) |
| `source`        | string   | Джерело відео або посилання на перегляд (опціонально)                      |
| `createdAt`     | Date     | Дата створення запису                                                      |
| `updatedAt`     | Date     | Дата останнього оновлення запису                                           |

### Опис додаткових полів

- **genres**: дозволяє фільтрувати та шукати фільми за жанрами.
- **actors/directors**: використовується для пошуку фільмів за конкретними акторами чи режисерами.
- **episodes**: якщо фільм є серіалом, тут зберігається інформація про кожну серію (наприклад, номер, назва, тривалість).
- **source**: може містити посилання на відео, трейлер або сторінку перегляду.

### Приклад об'єкта Movie

```json
{
  "id": "665f1c2e2e2e2e2e2e2e2e2e",
  "title": "Додому",
  "originalTitle": "Homeward",
  "description": "Драма про повернення до рідного дому.",
  "poster": "https://example.com/poster.jpg",
  "quality": "HD",
  "duration": "1 год 45 хв",
  "age": "12+",
  "year": "2024",
  "imdb": "7.8",
  "likes": "120",
  "dislikes": "3",
  "genres": ["драма", "сімейний"],
  "actors": ["Іван Петренко", "Олена Кравець"],
  "directors": ["Олександр Шевченко"],
  "countries": ["Україна"],
  "episodes": [],
  "source": "https://example.com/watch",
  "createdAt": "2024-06-01T12:00:00.000Z",
  "updatedAt": "2024-06-10T09:30:00.000Z"
}
```

## Можливі запити до API

### Фільми

- `GET /movies` — отримати список фільмів  
  **Параметри запиту:**
  - `page`: номер сторінки (за замовчуванням 1)
  - `limit`: кількість записів на сторінку (за замовчуванням 5, максимум 50)
  - `sort`: поле для сортування (наприклад, `{"year": -1}`)
  - `filters`: фільтри (наприклад, `{"genres": "драма"}`)

  **Відповідь:**  
  Об'єкт з пагінацією та масивом фільмів.

- `GET /movies/:id` — отримати фільм за ідентифікатором  
  **Відповідь:**  
  Об'єкт фільму.

- `POST /movies` — створити новий фільм  
  **Тіло запиту:**  
  Об'єкт фільму (без полів id, createdAt, updatedAt)

  **Відповідь:**  
  Створений об'єкт фільму.

- `PUT /movies/:id` — оновити дані фільму  
  **Тіло запиту:**  
  Об'єкт фільму з оновленими полями

  **Відповідь:**  
  Оновлений об'єкт фільму.

- `DELETE /movies/:id` — видалити фільм  
  **Відповідь:**  
  Видалений об'єкт фільму.

### Логи (Syslog)

- Логування запитів відбувається автоматично через middleware. Окремих ручних ендпоінтів для логів немає.

---

**Типові відповіді на помилки:**

- 400: Некоректний ідентифікатор запису
- 404: Запис не знайдено
- 500: Внутрішня помилка сервера

## Запуск програми

### Компіляція та гаряче перезавантаження для розробки

```bash
npm run dev
```

### Компіляція та мінімізація для виробництва

```bash
npm run build
```

### Перевікра з [ESLint](https://eslint.org/)

```bash
npm run lint
```

### Формат з [Prettier](https://prettier.io/)

```bash
npm run format
```

### Швидкий старт

```bash
npm run start
```

Після запуску програми на порту (3000 за замовчуванням) ви можете відкрити
у вашому веб-переглядачі служба підтримки API, ввівши http://localhost:3000/api
